<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>Sterowanie24.pl - Steruj</title>

    <!-- Bootstrap core CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
    <!-- Custom styles for this template -->

<style>
#sterowanie-logo {
  width: 80%;

}

.farbtastic {
  position: relative;
}
.farbtastic * {
  position: absolute;
  cursor: crosshair;
}
.farbtastic, .farbtastic .wheel {
  width: 195px;
  height: 195px;
}
.farbtastic .color, .farbtastic .overlay {
  top: 47px;
  left: 47px;
  width: 101px;
  height: 101px;
}
.farbtastic .wheel {
  background: url(wheel.png) no-repeat;
  width: 195px;
  height: 195px;
}
.farbtastic .overlay {
  background: url(mask.png) no-repeat;
}
.farbtastic .marker {
  width: 17px;
  height: 17px;
  margin: -8px 0 0 -8px;
  overflow: hidden;
  background: url(marker.png) no-repeat;
}

</style>

  </head>

  <body>
    <div id="menuu" style="text-align:center;padding: 0.5% 0.5% 0.5% 0.5%;position:absolute;top:85%;left:10%;background-color:#222222;border-style:solid;border-width:1em;border-color:#666666;border-radius:5px;display:none;">
      <div class="form-item"><label for="color">Color:</label><input type="text" id="color" name="color" value="#111111" /></div><div id="picker"></div>
    <button id="c" class="button pg" onclick="handlecolor('color', '8');">Confirm</button>
    </div>

    <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom box-shadow">
      <h5 class="my-2 mr-md-auto font-weight-normal" style="width: 30%;"><img src="sterowanie24-black-100height.png" id="sterowanie-logo"></h5>
      <nav class="my-2 my-md-0 mr-md-3">
<center>
        <a class="p-2 text-dark" href="#">O projekcie</a>
        <a class="p-2 text-dark" href="#">Statystyki</a>
            <a class="p-2 text-dark" href="#">Media</a>
          <a class="p-2 text-dark" href="#">Galeria</a>
        </center>
      </nav>
      <a class="btn btn-outline-primary" href="#">Zaloguj się</a>
    </div>

    <div class="text-center">
      <h1 class="display-4">Sterowanie</h1>
      <p class="lead">Jakiś fajny opis ;D</p>
    </div>

    <div class="container">
      <div class="card-deck mb-3 text-center" >
        <div class="card box-shadow">
          <div class="card-header">
            <h5 class="my-0 font-weight-normal">Panel sterowania</h5>
          </div>
          <div class="card-body" id="control_items_area">
            <div style="">  <p style="width: 75%;float: left;">Jeden kolor kotek</p> <button  style="width: 25%;" type="button" class="btn btn-sm btn-block btn-success">Włącz</button></div><div style="clear: both;"></div>
            <div style="">  <p style="width: 75%;float: left;">Jeden dzwonek kotek</p> <button  style="width: 25%;" type="button" class="btn btn-sm btn-block btn-danger">Wyłącz</button></div><div style="clear: both;"></div>

            <div style="">  <p style="width: 75%;float: left;">Różne kolory</p> <div style="width: 25%;" class="btn-group">
              <button style="width:100%;" type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Niebieski
              </button>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="#">Czerwony</a>
                <a class="dropdown-item" href="#">Zielony</a>
                <a class="dropdown-item" href="#">Niebieski</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">Wyłączony</a>
              </div>
            </div>  </div><div style="clear: both;"></div>
            <div style="">  <p style="width: 75%;float: left;">Suwak PWM Kolor żółty</p>     <input style="width: 25%;" type="range" class="form-control-range" id="formControlRange"></div><div style="clear: both;"></div>
            <div style="">  <p style="width: 75%;float: left;">Colorpicker np. dla diody WS2812</p>    <button  style="width: 25%;" type="button" class="btn btn-sm btn-block btn-danger" onclick="handleclickcolor('k1');" id="k1">Wybierz kolor</button></div><div style="clear: both;"></div>

            <!-- Example single danger button -->


          </div>

        </div>

        <div class="card box-shadow">
          <iframe width="560" height="315" src="https://www.youtube.com/embed/0Rv2O0lQNXs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

        </div>


      </div>


<div style="clear:both;"></div>
      <footer class="pt-4 my-md-5 pt-md-5 border-top">
        <div class="row">
          <div class="col-12 col-md">
            <img class="mb-2" src="../../assets/brand/bootstrap-solid.svg" alt="" width="24" height="24">
            <small class="d-block mb-3 text-muted">&copy; 2017-2018 Sterowanie24.pl Team</small>
          </div>
          <div class="col-6 col-md">
            <h5>O nas</h5>
            <ul class="list-unstyled text-small">
              <li><a class="text-muted" href="#">Kim jesteśmy</a></li>
              <li><a class="text-muted" href="#">Media</a></li>
              <li><a class="text-muted" href="#">Jak to się zaczęło?</a></li>

            </ul>
          </div>
          <div class="col-6 col-md">
            <h5>Zasoby</h5>
            <ul class="list-unstyled text-small">
              <li><a class="text-muted" href="#">A</a></li>
              <li><a class="text-muted" href="#">B</a></li>
              <li><a class="text-muted" href="#">C</a></li>
              <li><a class="text-muted" href="#">D</a></li>
            </ul>
          </div>
          <div class="col-6 col-md">
            <h5>Współpraca</h5>
            <ul class="list-unstyled text-small">
              <li><a class="text-muted" href="#">Sponsorzy</a></li>
              <li><a class="text-muted" href="#">Władze lokalne</a></li>
              <li><a class="text-muted" href="#">Dołącz do nas!</a></li>
              <li><a class="text-muted" href="#">Kontakt</a></li>
            </ul>
          </div>
        </div>
      </footer>
    </div>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"  crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
    <script>
      Holder.addTheme('thumb', {
        bg: '#55595c',
        fg: '#eceeef',
        text: 'Thumbnail'
      });
    </script>
    <script>
    jQuery.fn.farbtastic = function (callback) {
      $.farbtastic(this, callback);
      return this;
    };

    jQuery.farbtastic = function (container, callback) {
      var container = $(container).get(0);
      return container.farbtastic || (container.farbtastic = new jQuery._farbtastic(container, callback));
    }

    jQuery._farbtastic = function (container, callback) {
      // Store farbtastic object
      var fb = this;

      // Insert markup
      $(container).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');
      var e = $('.farbtastic', container);
      fb.wheel = $('.wheel', container).get(0);
      // Dimensions
      fb.radius = 84;
      fb.square = 100;
      fb.width = 194;

      // Fix background PNGs in IE6
      if (navigator.appVersion.match(/MSIE [0-6]\./)) {
        $('*', e).each(function () {
          if (this.currentStyle.backgroundImage != 'none') {
            var image = this.currentStyle.backgroundImage;
            image = this.currentStyle.backgroundImage.substring(5, image.length - 2);
            $(this).css({
              'backgroundImage': 'none',
              'filter': "progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='" + image + "')"
            });
          }
        });
      }

      /**
       * Link to the given element(s) or callback.
       */
      fb.linkTo = function (callback) {
        // Unbind previous nodes
        if (typeof fb.callback == 'object') {
          $(fb.callback).unbind('keyup', fb.updateValue);
        }

        // Reset color
        fb.color = null;

        // Bind callback or elements
        if (typeof callback == 'function') {
          fb.callback = callback;
        }
        else if (typeof callback == 'object' || typeof callback == 'string') {
          fb.callback = $(callback);
          fb.callback.bind('keyup', fb.updateValue);
          if (fb.callback.get(0).value) {
            fb.setColor(fb.callback.get(0).value);
          }
        }
        return this;
      }
      fb.updateValue = function (event) {
        if (this.value && this.value != fb.color) {
          fb.setColor(this.value);
        }
      }

      /**
       * Change color with HTML syntax #123456
       */
      fb.setColor = function (color) {
        var unpack = fb.unpack(color);
        if (fb.color != color && unpack) {
          fb.color = color;
          fb.rgb = unpack;
          fb.hsl = fb.RGBToHSL(fb.rgb);
          fb.updateDisplay();
        }
        return this;
      }

      /**
       * Change color with HSL triplet [0..1, 0..1, 0..1]
       */
      fb.setHSL = function (hsl) {
        fb.hsl = hsl;
        fb.rgb = fb.HSLToRGB(hsl);
        fb.color = fb.pack(fb.rgb);
        fb.updateDisplay();
        return this;
      }

      /////////////////////////////////////////////////////

      /**
       * Retrieve the coordinates of the given event relative to the center
       * of the widget.
       */
      fb.widgetCoords = function (event) {
        var x, y;
        var el = event.target || event.srcElement;
        var reference = fb.wheel;

        if (typeof event.offsetX != 'undefined') {
          // Use offset coordinates and find common offsetParent
          var pos = { x: event.offsetX, y: event.offsetY };

          // Send the coordinates upwards through the offsetParent chain.
          var e = el;
          while (e) {
            e.mouseX = pos.x;
            e.mouseY = pos.y;
            pos.x += e.offsetLeft;
            pos.y += e.offsetTop;
            e = e.offsetParent;
          }

          // Look for the coordinates starting from the wheel widget.
          var e = reference;
          var offset = { x: 0, y: 0 }
          while (e) {
            if (typeof e.mouseX != 'undefined') {
              x = e.mouseX - offset.x;
              y = e.mouseY - offset.y;
              break;
            }
            offset.x += e.offsetLeft;
            offset.y += e.offsetTop;
            e = e.offsetParent;
          }

          // Reset stored coordinates
          e = el;
          while (e) {
            e.mouseX = undefined;
            e.mouseY = undefined;
            e = e.offsetParent;
          }
        }
        else {
          // Use absolute coordinates
          var pos = fb.absolutePosition(reference);
          x = (event.pageX || 0*(event.clientX + $('html').get(0).scrollLeft)) - pos.x;
          y = (event.pageY || 0*(event.clientY + $('html').get(0).scrollTop)) - pos.y;
        }
        // Subtract distance to middle
        return { x: x - fb.width / 2, y: y - fb.width / 2 };
      }

      /**
       * Mousedown handler
       */
      fb.mousedown = function (event) {
        // Capture mouse
        if (!document.dragging) {
          $(document).bind('mousemove', fb.mousemove).bind('mouseup', fb.mouseup);
          document.dragging = true;
        }

        // Check which area is being dragged
        var pos = fb.widgetCoords(event);
        fb.circleDrag = Math.max(Math.abs(pos.x), Math.abs(pos.y)) * 2 > fb.square;

        // Process
        fb.mousemove(event);
        return false;
      }

      /**
       * Mousemove handler
       */
      fb.mousemove = function (event) {
        // Get coordinates relative to color picker center
        var pos = fb.widgetCoords(event);

        // Set new HSL parameters
        if (fb.circleDrag) {
          var hue = Math.atan2(pos.x, -pos.y) / 6.28;
          if (hue < 0) hue += 1;
          fb.setHSL([hue, fb.hsl[1], fb.hsl[2]]);
        }
        else {
          var sat = Math.max(0, Math.min(1, -(pos.x / fb.square) + .5));
          var lum = Math.max(0, Math.min(1, -(pos.y / fb.square) + .5));
          fb.setHSL([fb.hsl[0], sat, lum]);
        }
        return false;
      }

      /**
       * Mouseup handler
       */
      fb.mouseup = function () {
        // Uncapture mouse
        $(document).unbind('mousemove', fb.mousemove);
        $(document).unbind('mouseup', fb.mouseup);
        document.dragging = false;
      }

      /**
       * Update the markers and styles
       */
      fb.updateDisplay = function () {
        // Markers
        var angle = fb.hsl[0] * 6.28;
        $('.h-marker', e).css({
          left: Math.round(Math.sin(angle) * fb.radius + fb.width / 2) + 'px',
          top: Math.round(-Math.cos(angle) * fb.radius + fb.width / 2) + 'px'
        });

        $('.sl-marker', e).css({
          left: Math.round(fb.square * (.5 - fb.hsl[1]) + fb.width / 2) + 'px',
          top: Math.round(fb.square * (.5 - fb.hsl[2]) + fb.width / 2) + 'px'
        });

        // Saturation/Luminance gradient
        $('.color', e).css('backgroundColor', fb.pack(fb.HSLToRGB([fb.hsl[0], 1, 0.5])));

        // Linked elements or callback
        if (typeof fb.callback == 'object') {
          // Set background/foreground color
          $(fb.callback).css({
            backgroundColor: fb.color,
            color: fb.hsl[2] > 0.5 ? '#000' : '#fff'
          });

          // Change linked value
          $(fb.callback).each(function() {
            if (this.value && this.value != fb.color) {
              this.value = fb.color;
            }
          });
        }
        else if (typeof fb.callback == 'function') {
          fb.callback.call(fb, fb.color);
        }
      }

      /**
       * Get absolute position of element
       */
      fb.absolutePosition = function (el) {
        var r = { x: el.offsetLeft, y: el.offsetTop };
        // Resolve relative to offsetParent
        if (el.offsetParent) {
          var tmp = fb.absolutePosition(el.offsetParent);
          r.x += tmp.x;
          r.y += tmp.y;
        }
        return r;
      };

      /* Various color utility functions */
      fb.pack = function (rgb) {
        var r = Math.round(rgb[0] * 255);
        var g = Math.round(rgb[1] * 255);
        var b = Math.round(rgb[2] * 255);
        return '#' + (r < 16 ? '0' : '') + r.toString(16) +
               (g < 16 ? '0' : '') + g.toString(16) +
               (b < 16 ? '0' : '') + b.toString(16);
      }

      fb.unpack = function (color) {
        if (color.length == 7) {
          return [parseInt('0x' + color.substring(1, 3)) / 255,
            parseInt('0x' + color.substring(3, 5)) / 255,
            parseInt('0x' + color.substring(5, 7)) / 255];
        }
        else if (color.length == 4) {
          return [parseInt('0x' + color.substring(1, 2)) / 15,
            parseInt('0x' + color.substring(2, 3)) / 15,
            parseInt('0x' + color.substring(3, 4)) / 15];
        }
      }

      fb.HSLToRGB = function (hsl) {
        var m1, m2, r, g, b;
        var h = hsl[0], s = hsl[1], l = hsl[2];
        m2 = (l <= 0.5) ? l * (s + 1) : l + s - l*s;
        m1 = l * 2 - m2;
        return [this.hueToRGB(m1, m2, h+0.33333),
            this.hueToRGB(m1, m2, h),
            this.hueToRGB(m1, m2, h-0.33333)];
      }

      fb.hueToRGB = function (m1, m2, h) {
        h = (h < 0) ? h + 1 : ((h > 1) ? h - 1 : h);
        if (h * 6 < 1) return m1 + (m2 - m1) * h * 6;
        if (h * 2 < 1) return m2;
        if (h * 3 < 2) return m1 + (m2 - m1) * (0.66666 - h) * 6;
        return m1;
      }

      fb.RGBToHSL = function (rgb) {
        var min, max, delta, h, s, l;
        var r = rgb[0], g = rgb[1], b = rgb[2];
        min = Math.min(r, Math.min(g, b));
        max = Math.max(r, Math.max(g, b));
        delta = max - min;
        l = (min + max) / 2;
        s = 0;
        if (l > 0 && l < 1) {
          s = delta / (l < 0.5 ? (2 * l) : (2 - 2 * l));
        }
        h = 0;
        if (delta > 0) {
          if (max == r && max != g) h += (g - b) / delta;
          if (max == g && max != b) h += (2 + (b - r) / delta);
          if (max == b && max != r) h += (4 + (r - g) / delta);
          h /= 6;
        }
        return [h, s, l];
      }

      // Install mousedown handler (the others are set on the document on-demand)
      $('*', e).mousedown(fb.mousedown);

        // Init color
      fb.setColor('#000000');

      // Set linked elements/callback
      if (callback) {
        fb.linkTo(callback);
      }
    }




    function handlecolor(idfarb,id){
    	//var button=document.getElementById(id);
    	//button.classList.toggle("pgalt");
    	//button.classList.toggle("pg");
    	var color = document.getElementById(idfarb).value;
    	document.getElementById(id).style.backgroundColor = color;
    }
    function handleclickcolor(id){
    	//var button=document.getElementById(id);
    	//button.classList.toggle("pgalt");
    	//button.classList.toggle("pg");
    	if(!$('#menuu').is(":visible")) {
    	$("#" + id).show();
    	}
    	else{
            $('#' + id).hide();
        }
    }

    </script>
    <script type="text/javascript" charset="utf-8">

    function controlItemActionHandle(controlItemId) {
        var controlItemElement = $("#ci_" + controlItemId);
        if (controlItemElement.attr("data-control-item-type") == "1") {
            // Type is on/off button
            if (controlItemElement.val() == "0") {
               controlItemElement.val("1");
               controlItemElement.html("Wyłącz");
            } else {
               controlItemElement.val("0");
               controlItemElement.html("Włącz");
            }
        }
    }

    function dropdownControlItemActionHandle(controlItemId, dropdownOptionIndex) {
        var dropdownItem = $("#dropdown_item_ci_" + controlItemId + "_" + dropdownOptionIndex);
        var dropdownToggle = $("#dropdown_toggle_ci_" + controlItemId);
        var dropdownItemText = dropdownItem.text();

        dropdownToggle.html(dropdownItemText+' <span class="caret"></span>');
    }

    function handleRangeSliderAction (rangeSliderObject) {
        var controlItemId = rangeSliderObject.id;
        var rangeValue = rangeSliderObject.value;

        console.log("Range slider " + controlItemId  + " updated to " + rangeValue);
    }

    $(document).ready(function() {
       $('#picker').farbtastic('#color');

   /// Get controlling data

   var apiServerAddress = "http://localhost";
   var apiServerPort = 8000;

   var roomID = 1;
   $.ajax({
      //  headers: {"x-api-key" : "123ABC987XYZ"},
        url:apiServerAddress+":"+apiServerPort+"/rooms/"+roomID.toString()+"/controls",
        type:"GET",
        dataType: "json",
        success: function(response){
           /// Render control items
           for (let key in response) {
              console.log("key: %o, value: %o", key, response[key]);
              /* Types descriptions
               * 1 - standard on/off button
               * 2 - color picker button
               * 3 - range slider
               * 4 - select list
              */

              controlItemId = key;

              if (response[key].type == 1) {
                $("#control_items_area").append('<p style="width:'+response[key].name_area_width_percent+'%;color:'+response[key].textcolor+';float:left;">'+response[key].name+'</p><button data-control-item-type="1" onclick="controlItemActionHandle('+controlItemId+');" id="ci_'+controlItemId+'" style="width:'+response[key].control_item_width_percent+'%;" type="button" class="btn btn-sm btn-block btn-success" value="unspecified">Włącz</button><div style="clear: both;"></div>');
              } else if (response[key].type == 2) {
                $("#control_items_area").append('<p style="width:'+response[key].name_area_width_percent+'%;color:'+response[key].textcolor+';float:left;">'+response[key].name+'</p><button id="ci_'+controlItemId+'" style="width:'+response[key].control_item_width_percent+'%;" type="button" class="btn btn-sm btn-block btn-success" value="unspecified">Włącz</button><div style="clear: both;"></div>');
              } else if (response[key].type == 3) {
                $("#control_items_area").append('<p style="width:'+response[key].name_area_width_percent+'%;color:'+response[key].textcolor+';float:left;">'+response[key].name+'</p><input id="ci_'+controlItemId+'" style="width:'+response[key].control_item_width_percent+'%;" type="range" class="form-control-range" id="formControlRange" min="'+response[key].range_slider_from+'" max="'+response[key].range_slider_to+'" oninput="handleRangeSliderAction(this)" onchange="handleRangeSliderAction(this)"><div style="clear: both;"></div>');
              } else if (response[key].type == 4) {
                var dropdownButton = '<button id="dropdown_toggle_ci_'+controlItemId+'" style="width:100%;" type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Niebieski</button>';
                var comboboxData = '<div class="dropdown-menu">';
                for (let key2 in response[key].combobox_options) {
                    comboboxData += '<a class="dropdown-item" onclick="dropdownControlItemActionHandle('+controlItemId+', '+key2+');" id="dropdown_item_ci_'+controlItemId+'_'+key2+'">' + response[key].combobox_options[key2] + '</a>';
                }
                comboboxData += '</div>';
                $("#control_items_area").append('<p style="width:'+response[key].name_area_width_percent+'%;color:'+response[key].textcolor+';float:left;">'+response[key].name+'</p><div style="width:'+response[key].control_item_width_percent+'%;" class="btn-group"> ' + dropdownButton + comboboxData + ' </div><div style="clear: both;"></div>');
              }

           }
          // $(".dropdown-menu a").click(function(){
            // console.log("actionType");
              // var selText = $(this).text();
              // $(this).parents('.card-body').find('.dropdown-toggle').html(selText+' <span class="caret"></span>');
           //});
          console.log(response);
        }
      });

  });

//  <div class="dropdown-divider"></div>

    </script>





  </body>
</html>
